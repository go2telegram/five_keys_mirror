# Центр знаний

Центр знаний хранит причины операционных решений и позволяет быстро объяснить их через команду `/why`.

## Структура данных

- `knowledge/base.json` — актуальное состояние базы знаний. Каждая запись содержит поля:
  - `event` — идентификатор события.
  - `reason` — описание причины решения.
  - `actions` — список предпринятых шагов.
  - `timestamp` — ISO-временная метка последнего обновления записи.
- `knowledge/history.jsonl` — журнал изменений. На каждое обновление добавляется строка JSON с полями `op`, `event`, `reason`, `actions`, `timestamp`, `actor`, `recorded_at`.

## Команды

- `/why <event>` — показывает причину и действия для события. Если Центр знаний выключен, бот сообщит об этом.
- `/why_events` — перечисляет все доступные события.
- `/setwhy <event> | <reason> | <action 1>; <action 2>` — обновляет или создаёт запись. Команда доступна только админу (`settings.ADMIN_ID`).

## Фича-флаг

Переменная окружения `ENABLE_KNOWLEDGE_CENTER` управляет доступностью Центра знаний. Установите `ENABLE_KNOWLEDGE_CENTER=false`, чтобы полностью отключить команду `/why` и связанные ответы без удаления данных.

## Пример события

База содержит тестовую запись `error_rate_spike`. Команда `/why error_rate_spike` вернёт причину роста ошибок и предпринятые действия — используйте её для smoke-теста.
