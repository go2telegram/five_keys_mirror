# Каталог продуктов

## UI и команды

* `/catalog` — открывает список категорий. Кнопки ведут к листингу товаров внутри категории, есть пагинация и возврат в главное меню.
* Выбор категории показывает список карточек: короткое описание и кнопки для перехода к полному описанию товара.
* Карточка товара отправляется отдельным сообщением с фото, подробным описанием и кнопками «Купить» (переход по ссылке) и «Назад».
* `/product <ID>` — прямой переход к карточке по идентификатору (например, `/product T8_EXTRA`).
* `/find <запрос>` — поиск по названию, краткому описанию и тегам. Результат отображает список с быстрыми кнопками перехода к карточкам.
* `/catalog_reload` — админ-команда для принудительного обновления данных каталога из `app/data/products.json`.

## Загрузка и настройки

* Данные каталога описываются в `app/data/products.json`. Структура валидируется по схеме, ошибки выводятся в лог и в ответ админ-команде перезагрузки.
* При старте приложения вызывается `load_products()`, данные кэшируются в памяти. Повторные вызовы выполняются мгновенно до изменения файла.
* Флаг `ENABLE_CATALOG_UI` в `Settings` позволяет отключить обработчики `/catalog`, `/product`, `/find`, оставив только загрузчик и админскую перезагрузку (для отката достаточно выставить `false`).

## Телеметрия

* Просмотры карточек пишутся в событие `product_view`.
* Нажатие кнопки «Купить» фиксируется событием `product_click_buy` перед открытием ссылки.
* Поиск через `/find` регистрируется событием `catalog_search` с текстом запроса и найденными ID.
