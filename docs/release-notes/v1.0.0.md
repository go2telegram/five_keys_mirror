# v1.0.0 — Production-ready build (catalog, CI, health, metrics)

## Highlights
- ✅ Schema-backed product catalog с консистентными Velavie UTM.
- ✅ Полноценная наблюдаемость: /ping, /metrics, audit tooling, smoke/pytest.
- ✅ Каталог в боте: /catalog, /product <id>, /find; админ-команды и nightly-проверки.
- ✅ CI: сборка/валидация каталога, тесты, предупреждения о битых картинках.
- ✅ Docker HEALTHCHECK → упрощённая эксплуатация и алертинг.

## New
- /catalog, /product <id>, /find — карточки с фото, описанием, кнопкой «Купить».
- Admin: /catalog_reload, /catalog_stats, /catalog_broken (+ cron check).
- Health & Observability: /ping, /metrics, /version, audit скрипт (tools/audit_repo.sh).
- Catalog toolchain: tools/build_products.py + app/data/products.schema.json.
- (Опционально) Redis-бэкенд для троттлинга/FSM (USE_REDIS=1).

## Improvements
- Стартовый поток: троттлинг и ACL по admin-ID, уведомление админов при старте.
- Единый формат каталога (app/catalog/products.json) + strict JSON Schema.
- UTM-метки унифицированы (utm_source=tg_bot, utm_medium=catalog, utm_campaign=<category>, utm_content=<product_id>).

## DevOps / DX
- CI Workflow: build-products, validate-products, pytest, audit, HEAD-check картинок (warning-only).
- Dockerfile: HEALTHCHECK на GET /ping.
- Makefile: цели build-products / validate-products.
- README: как собрать, валидировать и запустить.

## Breaking / Compatibility
- Источник каталога — `app/catalog/products.json` (валидируется схемой `app/data/products.schema.json`).
- Картинки/описания — из внешнего репозитория `go2telegram/media` (в код медиa не коммитим).

## How to upgrade
```bash
git fetch --all --prune
git switch main
git pull --ff-only origin main
make build-products && make validate-products
export BOT_TOKEN=xxx HEALTH_PORT=8080
python run.py  # /ping, /metrics, /version, /catalog
```

## Notes

Ветка main защищена: требуются зелёные проверки и merge через PR.

Для многорепличного запуска включайте USE_REDIS=1 и настраивайте REDIS_URL.
